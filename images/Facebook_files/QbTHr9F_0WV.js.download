;/*FB_PKG_DELIM*/

__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.storedProcedure(b("LSGetCursor"),c.i64.cast([0,1])).then(function(a){return a=a,d[0]=a[0],a})},function(e){return c.db.table(17).fetch([[[a[0],a[1]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[2]=d[6])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("media_group",a[1]),d[4].set("max_timestamp_ms",c.i64.cast([2328,1316134911])),d[4].set("cursor",d[0]),d[4].set("sync_group",d[2]),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,f.hasMoreBefore?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[2]=d[6])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("media_group",a[1]),d[4].set("max_timestamp_ms",f.minTimestampMs),d[4].set("cursor",d[0]),d[4].set("sync_group",d[2]),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.resolve())})}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","cr:8709"],(function(a,b,c,d,e,f,g){function a(a,b){var d=[];d[0]=b.threadKey;d[1]=b.mediaGroup;return c("LSIssueAttachmentsRangeQuery").apply(void 0,d.concat([a]))}g["default"]=a}),98);
__d("MDSShareSvgIcon.react",["MDSSvgIcon.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){return i.jsxs(c("MDSSvgIcon.react"),babelHelpers["extends"]({},a,{children:[i.jsx("path",{d:"M18.766 4.857a1 1 0 00-1.532 0L13.878 8.86a1 1 0 00.766 1.643H16.5a.25.25 0 01.25.25v10.75a1 1 0 001 1h.5a1 1 0 001-1v-10.75a.25.25 0 01.25-.25h1.856a1 1 0 00.766-1.643l-3.356-4.002z"}),i.jsx("path",{d:"M14.75 13.502a1 1 0 00-1-1H12.5a4 4 0 00-4 4v8.5a4 4 0 004 4h11a4 4 0 004-4v-8.5a4 4 0 00-4-4h-1.25a1 1 0 00-1 1v.5a1 1 0 001 1h1.25a1.5 1.5 0 011.5 1.5v8.5a1.5 1.5 0 01-1.5 1.5h-11a1.5 1.5 0 01-1.5-1.5v-8.5a1.5 1.5 0 011.5-1.5h1.25a1 1 0 001-1v-.5z"})]}))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MessagingAttachmentType","RavenMessagingState","ReQL","ReQLSuspense","filterNulls","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=i||(i=d("react"));e=i;var m=e.createContext,n=e.useCallback,o=e.useEffect,p=e.useMemo,q=e.useState,r=b("$InternalEnum")({Image:0,Video:1}),s=m({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0});function t(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function u(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function v(a,b,c,d){return c?d.hasMedia:b(d,"isPlayableMedia")!=null&&a(d,"isPlayableMedia")!=null}function w(a,b,e,f){var g=f.attachmentType;return!v(a,b,e,f)?!1:t(f)||(j||(j=d("I64"))).equal(g,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))}function x(a,b,e,f){var g=f.attachmentType;return!v(a,b,e,f)?!1:u(f)||(j||(j=d("I64"))).equal(g,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function y(a,b){o(function(){a.forEach(function(a){try{b(a.attachment,"usePreloadThumbnails");return}catch(a){return}})},[a,b])}function z(a){var b=a.attachments,d=a.children,e=a.getIsSecureThread,f=a.getPlayableUrl,g=a.getPreviewUrl;a=a.initialAttachment;a=q(a);var h=a[0],i=a[1],j=p(function(){return c("filterNulls")(b.map(function(a){var b=e(a);if(w(f,g,b,a))return{attachment:a,type:r.Image};return x(f,g,b,a)?{attachment:a,type:r.Video}:null}))},[b,e,f,g]),k=h==null?-1:j.findIndex(function(a){return a.attachment.attachmentFbid===h.attachmentFbid&&a.attachment.messageId===h.messageId});y(j,g);a=p(function(){var a=Math.max(0,j.length-1);return{canMoveBackward:k>0&&k!==-1,canMoveForward:k<a&&k!==-1,card:j[k],cards:j,currentIndex:k,moveBackward:function(){var a=Math.max(k-1,0);i((a=j[a])==null?void 0:a.attachment)},moveForward:function(){var b=Math.min(k+1,a);i((b=j[b])==null?void 0:b.attachment)},moveTo:function(a){i(a.attachment)},numberOfCards:j.length}},[k,j]);return l.jsx(s.Provider,{value:a,children:d})}z.displayName=z.name+" [from "+f.id+"]";function a(a){var b=a.attachmentFbid,e=a.children,g=a.getPlayableUrl,i=a.getPreviewUrl,k=a.isSecureThread,m=a.threadKey,o=(h||(h=c("useReStore")))();a=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return a.attachmentFbid===b})},[o,m,b],f.id+":258");var q=d("ReQLSuspense").useArray(function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return w(g,i,k,a)||x(g,i,k,a)})},[m,o],f.id+":266"),r=p(function(){return q.sort(function(a,b){return(j||(j=d("I64"))).compare(b.timestampMs,a.timestampMs)})},[q]),s=n(function(){return k},[k]);return l.jsx(z,{attachments:r,getIsSecureThread:s,getPlayableUrl:g,getPreviewUrl:i,initialAttachment:a,children:e})}a.displayName=a.name+" [from "+f.id+"]";g.AttachmentMediaType=r;g.context=s;g.MWChatAttachmentMediaStateProviderFromAttachments=z;g.MWChatAttachmentMediaStateProvider=a}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","react","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext,l=b.useMemo,m={key:c("CometKeys").LEFT},n={key:c("CometKeys").RIGHT},o=h._("__JHASH__6tFY25IlnV4__JHASH__"),p=h._("__JHASH__HYvhkJNYo2M__JHASH__");function a(a){a=a.children;var b=k(d("MWChatAttachmentMediaState.react").context),e=b.moveBackward,f=b.moveForward;b=l(function(){return[{command:m,description:o,handler:e},{command:n,description:p,handler:f}]},[f,e,m,n,o,p]);c("useLayerKeyCommands")(b);return j.jsx("div",{children:(b=a)!=null?b:null})}a.displayName=a.name+" [from "+f.id+"]";g.keyLeft=m;g.keyRight=n;g.MWChatAttachmentMediaNavigationHotkeys=a}),226);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useDeferredValue;function l(a,b){var c=b.attachment;if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){return{alt:(b=c.accessibilitySummaryText)!=null?b:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:(b=a(c,"toFilmstripThumbnail"))!=null?b:"",width:0}}return{height:0,mediaType:"video",thumbnailUri:(b=a(c,"toFilmstripThumbnail"))!=null?b:"",uri:(b=a(c,"toFilmstripThumbnail"))!=null?b:"",width:0}}function m(a){var b=a.activeCard,d=a.cards,e=a.getPreviewUrl,f=a.onSetImage;a=d.map(function(a){return l(e,a)});var g=d.findIndex(function(a){var c;return a.attachment.attachmentFbid===(b==null?void 0:(c=b.attachment)==null?void 0:c.attachmentFbid)&&a.attachment.messageId===(b==null?void 0:(c=b.attachment)==null?void 0:c.messageId)});return i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:g,images:a,onSetImage:function(a){return f(d[a])}})}m.displayName=m.name+" [from "+f.id+"]";function a(a){a=a.getPreviewUrl;var b=j(d("MWChatAttachmentMediaState.react").context),e=b.card,f=b.cards;b=b.moveTo;f=k(f);return i.jsx("div",{className:"xdj266r xkrivgy xat24cr x1gryazu x193iq5w x6ikm8r x10wlt62",children:i.jsx(c("CometPlaceholder.react"),{fallback:null,children:i.jsx(m,{activeCard:e,cards:f,getPreviewUrl:a,onSetImage:b})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWChatForwardCircleButton.react",["fbt","MDSShareSvgIcon.react","ODS","SVGIcon","TetraCircleButton.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a){a.attachmentID;var b=a.color,e=a.onOpenForwardDialog,f=a.type;return k.jsx(c("TetraCircleButton.react"),{icon:d("SVGIcon").legacySVGIcon(function(){return k.jsx(c("MDSShareSvgIcon.react"),{color:b,size:24})}),label:h._("__JHASH__GvPr2MwluxY__JHASH__"),onPress:function(){(j||(j=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),e()},size:36,testid:void 0,type:function(){switch(f){case"deemphasized":return"deemphasized";case"normal":return"normal";case"overlay":return"overlay";case"dark_overlay":return"dark-overlay";case"deemphasized_overlay":case"overlay_raised":return"overlay-raised";case"primary_background_overlay":return"primary-background-overlay"}}()})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"full_screen_view")}g.useMediaViewerRenderQpl=a}),98);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","gkx","react","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react"),m=l.useCallback,n=l.useEffect,o=l.useState;function a(a,b,d,e,f){var g=o(!1),h=g[0],i=g[1],j=a.length,k=(g=c("usePrevious")(j))!=null?g:0,l=c("usePrevious")(b);n(function(){d==null&&f!==!0&&(e(),c("gkx")("736")&&i(!0))},[d,e,f]);n(function(){var a=k!==j,e=l===!0&&!b||c("gkx")("736")&&d==null&&b===!1&&l===!1&&k===j;h&&(e||a)&&i(!1)},[j,b,h,k,l,d]);a=m(function(){if(!h){e();return i(!0)}},[h,e,i]);g=j>0||!h&&!b;return[h,a,g]}function p(a,b,e,g){var j;g=g===void 0?{}:g;g=g.removeUnsentMessages;var k=g===void 0?!1:g,l=(h||(h=c("useReStore")))();g=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(l.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,b)})},[l,a,b],f.id+":101");var n=g==null?void 0:g.minTimestampMs;j=c("gkx")("736")?g==null?void 0:g.hasMoreBefore:(j=g==null?void 0:g.hasMoreBefore)!=null?j:!1;var o=m(function(a){if(!e(a))return null;if(!k)return a;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(l.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":122");return b==null||b.isUnsent?null:a},[l,e,k]),p=d("ReQLSuspense").useArray(function(){var b=d("ReQL").fromTableDescending(l.tables.attachments.index("fk_messages")).getKeyRange(a);return b.map(o).filter(Boolean)},[l,a,o],f.id+":135");return[p,g,n,j]}function q(a){var b=a.attachmentType;a=a.defaultCtaType;return(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?a==="xma_web_url":!1}function b(a,b){a=p(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),q,b);b=a[0];var e=a[1],f=a[2];a=a[3];return[b,j.ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e,f,a]}function r(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function e(a,b){a=p(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),r,b);b=a[0];var e=a[1],f=a[2];a=a[3];return[b,j.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e,f,a]}function s(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))}function t(a,b){a=p(a,(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),s,b);b=a[0];var e=a[1],f=a[2];a=a[3];return[b,j.ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e,f,a]}g.useLoader=a;g.useQueryLinkAttachments=b;g.useQueryMediaAttachments=e;g.useQueryFileAttachments=t}),98);
__d("MWV2MediaViewerContext.react",["react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useMemo,k=i.createContext({getDownloadUrl:function(){},getPlayableUrl:function(){},getPreviewUrl:function(){},heroLoggingComponent:function(a){return null},loadMore:function(){},media:[]});function a(a){var b=a.children,c=a.getDownloadUrl,d=a.getPlayableUrl,e=a.getPreviewUrl,f=a.heroLoggingComponent,g=a.loadMore,h=a.media;a=j(function(){return{getDownloadUrl:c,getPlayableUrl:d,getPreviewUrl:e,heroLoggingComponent:f,loadMore:g,media:h}},[c,d,e,f,g,h]);return i.jsx(k.Provider,{value:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g.context=k;g.MWV2MediaViewerContextProvider=a}),98);
__d("MWV2MediaViewerControls.react",["fbt","ix","Int64Hooks","LSMessagingThreadTypeUtil","MDSRow.react","MDSRowItem.react","MWChatForwardCircleButton.react","MWV2MediaViewerContext.react","MWXTooltip.react","TetraCircleButton.react","fbicon","react","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react")),l=j.useContext,m=h._("__JHASH__yVgFxyhzJWR__JHASH__");function a(a){var b=a.attachment,e=a.message,f=a.onClose;a=a.thread;var g=l(d("MWV2MediaViewerContext.react").context);g=g.getDownloadUrl(b,"MWV2MediaViewerControls");return k.jsxs(c("MDSRow.react"),{paddingTop:0,spacing:8,children:[g!=null?k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("MWXTooltip.react"),{tooltip:m,children:k.jsx(c("TetraCircleButton.react"),{color:"white",icon:d("fbicon")._(i("1873235"),16),label:m,linkProps:{download:!0,target:"_blank",url:g},size:36,type:"dark-overlay"})})}):null,e!=null?k.jsx(n,{attachment:b,message:e,thread:a}):null,f!=null?k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("TetraCircleButton.react"),{color:"white",icon:d("fbicon")._(i("478232"),16),label:h._("__JHASH__gaxHiFwvIGk__JHASH__"),onPress:f,size:36,type:"dark-overlay"})}):null]})}a.displayName=a.name+" [from "+f.id+"]";function n(a){var b=a.attachment,e=a.message,f=a.thread;a=b==null?void 0:b.attachmentFbid;var g=d("LSMessagingThreadTypeUtil").isArmadilloSecure(f.threadType),i=d("Int64Hooks").useMemoInt64(function(){return f.threadType},[f.threadType]);g=c("useMWV2MessageForwardAction")(g,e,i);i=c("useMWHasForwardAction")(f.threadType,e,b);e=i.shouldShowForwardAction;return a==null||!e?null:k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("MWXTooltip.react"),{tooltip:h._("__JHASH__GvPr2MwluxY__JHASH__"),children:k.jsx(c("MWChatForwardCircleButton.react"),{attachmentID:a,color:"white",onOpenForwardDialog:g,type:"dark_overlay"})})})}n.displayName=n.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWV2MediaViewerItemImage.react",["MWV2MediaViewerContext.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useEffect,l=b.useRef;function a(a){var b=a.attachment,c=a.mediaRenderQpl;a=j(d("MWV2MediaViewerContext.react").context);var e=a.getPlayableUrl;a=a.heroLoggingComponent;var f=l(null);k(function(){var a;f.current!=null&&((a=f.current)==null?void 0:a.complete)&&c.endSuccess()},[c]);e=e(b,"MediaViewerImage",c);if(e!=null)return i.jsxs(i.Fragment,{children:[a("MWV2MediaViewerImage"),i.jsx("img",{className:"xr1yuqi xkrivgy x4ii5y1 x1gryazu xmz0i5r x193iq5w",onError:function(){c.endFail("load-image-error")},onLoad:function(){c.endSuccess()},ref:f,src:e})]});else{c.endFail("missing-playable-url");return null}}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var b=a.attachment;a=a.mediaRenderQpl;var e=j(d("MWV2MediaViewerContext.react").context);e=e.getPlayableUrl;e=e(b,"MediaViewerVideo",a);if(e!=null)return i.jsx("div",{className:"x78zum5 x1iyjqo2 xmz0i5r",children:i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:b.attachmentFbid,hideExpandButton:!c("gkx")("721"),mediaRenderQpl:a,originalHeight:1e3,originalWidth:1e3,sdSrc:e,shouldForcePauseOnClick:!1})});else{a.endFail("missing-playable-url");return null}}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","TetraNullState.react","react"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){return j.jsx(c("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:j.jsx(c("CometColumnItem.react"),{children:j.jsx(c("TetraNullState.react"),{headline:h._("__JHASH__f1n8ff4Nrlh__JHASH__")})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWMediaViewerRenderQpl","MWV2MediaViewerItemImage.react","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||d("react");function a(a){var b=a.attachment;a=a.threadType;if(b==null)return k.jsx(c("MWV2MediaViewerNullState.react"),{});var e=b.attachmentType;return!((i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))?k.jsx(c("MWV2MediaViewerNullState.react"),{}):k.jsx(l,{attachment:b,threadType:a})}a.displayName=a.name+" [from "+f.id+"]";function l(a){var b=a.attachment;a=a.threadType;a=d("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(b,a);var e=b.attachmentType;return(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?k.jsx(c("MWV2MediaViewerItemImage.react"),{attachment:b,mediaRenderQpl:a}):(i||(i=d("I64"))).equal(e,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?k.jsx(c("MWV2MediaViewerItemVideo.react"),{attachment:b,mediaRenderQpl:a}):null}l.displayName=l.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometBlurredBackgroundImage.react","CometHideLayerOnEscape.react","CometPlaceholder.react","I64","LSIntEnum","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControls.react","MWV2MediaViewerItem.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","react","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react"));b=j;var n=b.useContext,o=b.useEffect,p={mediaRow:{minHeight:"x2lwn1j",$$css:!0}};function q(a){a=a.attachment;var b=n(d("MWV2MediaViewerContext.react").context);b=b.getPreviewUrl;b=b(a,"BlurredBackground");if(b!=null&&a!=null&&!(k||(k=d("I64"))).equal(a.attachmentType,(l||(l=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return m.jsx("div",{className:"x1ey2m1c xds687c xuzhngd x10l6tqk x17qophe x13vifvy",children:m.jsx(c("CometBlurredBackgroundImage.react"),{src:b})});else return null}q.displayName=q.name+" [from "+f.id+"]";function a(a){var b=a.initialAttachment,e=a.onClose,g=a.shouldShowMessengerLogo;a=a.thread;var j=n(d("MWChatAttachmentMediaState.react").context),k=j.canMoveBackward,l=j.canMoveForward,r=j.card,s=j.currentIndex,t=j.moveBackward,u=j.moveForward,v=j.numberOfCards;j=n(d("MWV2MediaViewerContext.react").context);var w=j.getPreviewUrl,x=j.loadMore,y=(i||(i=c("useReStore")))(),z=b==null?void 0:b.threadKey,A=b==null?void 0:b.messageId;j=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableDescending(y.tables.attachments).getKeyRange(z,A)},[y,A,z],f.id+":97")!=null;r=r!=null?r.attachment:j?b:void 0;j=(r==null?void 0:r.messageId)!=null?d("ReQLSuspense").first(d("ReQL").fromTableAscending(y.tables.messages.index("messageId")).getKeyRange(r.messageId),f.id+":114"):null;o(function(){s>v-5&&x()},[s,v,x]);b=m.jsx(c("MWV2MediaViewerItem.react"),{attachment:r,threadType:a.threadType});j=m.jsxs(c("MWV2MediaViewerContainer.react"),{actions:m.jsx(c("CometPlaceholder.react"),{fallback:null,children:m.jsx(c("MWV2MediaViewerControls.react"),{attachment:r,message:j,onClose:e,thread:a})}),shouldShowMessengerLogo:g,children:[m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{}),m.jsx(c("CometPlaceholder.react"),{fallback:null,children:m.jsx(q,{attachment:r})}),m.jsxs(c("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[m.jsx(c("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,verticalAlign:"stretch",xstyle:p.mediaRow,children:[m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",disable:!1,invisible:!k,label:h._("__JHASH__LwpPfoJWBJ-__JHASH__"),onClick:t,testid:void 0})}),m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",children:m.jsx(c("CometPlaceholder.react"),{fallback:null,children:b})}),m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",disable:!1,invisible:!l,label:h._("__JHASH__37s-bUHecpV__JHASH__"),onClick:u,testid:void 0})})]})}),m.jsx(c("MWXColumnItem.react"),{children:m.jsx(c("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:w})})]})]});if(e!=null)return m.jsx(c("CometHideLayerOnEscape.react"),{onHide:e,children:j});else return j}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","gkx","promiseDone","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=c("useAsyncReStore")(),e=d("MWThreadKey.react").useMWThreadKeyMemoizedExn(),g=d("MAWThreadCutover").useGetCutoverOpenThreadKey(e);return d("Int64Hooks").useCallbackInt64(function(){c("promiseDone")(b,function(b){return b.runInTransaction(function(b){return c("LSIssueAttachmentsRangeQueryStoredProcedure")(c("LSFactory")(b),{mediaGroup:a,threadKey:g&&c("gkx")("736")?g:e})},"readwrite",void 0,void 0,f.id+":33")})},[b,a,g,e])}g["default"]=a}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","MAWBridgeSendAndReceive","MAWDbMedia","MAWMiActOnActThreadReady","gkx","promiseDone","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(i||d("react")).useCallback,l=(j||(j=d("I64"))).of_string("9999999999999");function a(a,b,e,f){var g=(h||(h=c("useReStore")))(),i=k(function(){return b!=null&&b&&e!=null?c("gkx")("736")?(j||(j=d("I64"))).to_float(e):(j||(j=d("I64"))).to_int32(e):c("gkx")("736")?Number.MAX_SAFE_INTEGER:(j||(j=d("I64"))).to_int32(l)},[b,e]),m=(f=f)!=null?f:Number.MAX_SAFE_INTEGER;return k(function(){a!=null&&c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(g.tables,a,"useMAWLoadMoreThreadSharedAttachments",function(a,b,c){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaId:d("MAWDbMedia").convertNumberToMediaId(m),earliestLoadedMediaTs:i(),threadId:b,threadJid:c})}))},[a,g.tables,m,i])}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMedia","MWSharedAttachmentsSectionHooks","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var e,f,g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a),h=g[0],i=g[1],j=g[2],k=g[3];g=g[4];e=(e=g)!=null?e:!0;f=(f=h[h.length-1])==null?void 0:f.attachmentFbid;a=c("useMAWLoadMoreThreadSharedAttachments")(a,g,k,f!=null?d("MAWDbMedia").convertNumberToMediaId(Number(f)):void 0);g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(b);k=g[0];f=g[2];b=g[4];b=(g=b)!=null?g:!1;g=c("useLoadMoreThreadSharedAttachments.react")(i);i=d("MWSharedAttachmentsSectionHooks").useLoader(h,e,j,a);j=i[0];a=i[1];i=i[2];f=d("MWSharedAttachmentsSectionHooks").useLoader(k,b,f,g,e);g=f[0];var l=f[1];f=f[2];if(e||j)return{attachments:h,completedFirstLoad:i,hasMore:e,isLoadingMore:j,onLoadMore:a};else if(b||g)return{attachments:h.concat(k),completedFirstLoad:f,hasMore:b,isLoadingMore:g,onLoadMore:l};else return{attachments:h.concat(k),completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:function(){}}}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(h||d("react")).useCallback;function a(){return k(function(a){return a==null?void 0:(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?d("LSMediaUrlAttachment").previewUrl(a):d("LSMediaUrlAttachment").playableUrl(a)},[])}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){return i(function(a){return a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0},[])}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePlayableUrl",["cr:5970","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){return i(function(a,c,d){return(a=b("cr:5970")==null?void 0:b("cr:5970").getAttachmentBlob(a,c,d))!=null?a:""},[])}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePreviewUrl",["cr:5931","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){return i(function(a,c,d){return b("cr:5931")==null?void 0:b("cr:5931")(a,c,d)},[])}g["default"]=a}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","emptyFunction","react","useMAWLoadMoreCutoverThreadSharedAttachments","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback;function a(a){var b=a.children,e=a.initialAttachment,f=a.openThreadKey;a=a.secureThreadKey;a=c("useMAWLoadMoreCutoverThreadSharedAttachments")(a,f);f=a.attachments;a=a.onLoadMore;var g=j(function(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")},[]),h=c("useMWV2MediaViewerOpenPreviewUrl")(),k=c("useMWV2MediaViewerOpenPlayableUrl")(),l=c("useMWV2MediaViewerSecurePreviewUrl")(),m=c("useMWV2MediaViewerSecurePlayableUrl")(),n=j(function(a,b,c){if(!a)return"";return!g(a)?h(a,b,c):l(a,b,c)},[g,h,l]),o=j(function(a,b,c){if(a==null)return"";return!g(a)?k(a,b,c):m(a,b,c)},[g,k,m]);return i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:o,getPlayableUrl:o,getPreviewUrl:n,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:f,children:i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:f,getIsSecureThread:g,getPlayableUrl:o,getPreviewUrl:n,initialAttachment:e,children:b})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","useLoadMoreThreadSharedAttachments.react","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback;function a(a){var b=a.children,e=a.initialAttachment;a=a.thread;a=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey);var f=a[0],g=a[1],h=a[2];a[3];a=a[4];g=c("useLoadMoreThreadSharedAttachments.react")(g);a=d("MWSharedAttachmentsSectionHooks").useLoader(f,(a=a)!=null?a:!0,h,g);h=a[1];g=c("useMWV2MediaViewerOpenPreviewUrl")();a=c("useMWV2MediaViewerOpenPlayableUrl")();var k=j(function(){return!1},[]);return i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:a,getPlayableUrl:a,getPreviewUrl:g,heroLoggingComponent:function(a){return i.jsx(c("CometHero.react"),{description:a})},loadMore:h,media:f,children:i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:f,getIsSecureThread:k,getPlayableUrl:a,getPreviewUrl:g,initialAttachment:e,children:b})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewerSecureWrapper.react",["MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:5709","cr:5931","cr:5970","emptyFunction","react","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useCallback,k=b("cr:5709")==null?function(a,b,c){return function(){}}:b("cr:5709");function a(a){var e=a.children,f=a.initialAttachment;a=a.thread;var g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey),h=g[0];g[1];g[2];var l=g[3];g=g[4];a=k(a.threadKey,g,l);g=(g=g)!=null?g:!0;g=d("MWSharedAttachmentsSectionHooks").useLoader(h,g,l,a);l=g[1];a=c("useMWV2MediaViewerSecurePreviewUrl")();g=c("useMWV2MediaViewerSecurePlayableUrl")();var m=j(function(){return!0},[]);return b("cr:5970")==null||b("cr:5931")==null?i.jsx(c("MWV2MediaViewerNullState.react"),{}):i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:g,getPlayableUrl:g,getPreviewUrl:a,heroLoggingComponent:c("emptyFunction"),loadMore:l,media:h,children:i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:m,getPlayableUrl:g,getPreviewUrl:a,initialAttachment:f,children:e})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MWV2MediaViewer.react",["FBLogger","I64","LSMessagingThreadTypeUtil","MAWThreadCutover","MWLSThread","MWV2MediaViewerContent.react","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||d("react");function a(a){var b=a.attachment,e=a.onClose;a=a.shouldShowMessengerLogo;var f=d("MWLSThread").useThread(b.threadKey),g=d("MAWThreadCutover").useGetCutoverOpenThreadKey(b.threadKey),h=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(g==null?b.threadKey:void 0);if(f==null){c("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(i||(i=d("I64"))).to_string(b.threadKey));return j.jsx(c("MWV2MediaViewerNullState.react"),{})}var k=d("LSMessagingThreadTypeUtil").isArmadilloSecure(f.threadType);if(c("gkx")("736")&&(g!=null||h!=null))return j.jsx(c("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:b,openThreadKey:g!=null?g:f.threadKey,secureThreadKey:h!=null?h:f.threadKey,children:j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:b,onClose:e,shouldShowMessengerLogo:a,thread:f})});return k?j.jsx(c("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:b,thread:f,children:j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:b,onClose:e,shouldShowMessengerLogo:a,thread:f})}):j.jsx(c("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:b,thread:f,children:j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:b,onClose:e,shouldShowMessengerLogo:a,thread:f})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);